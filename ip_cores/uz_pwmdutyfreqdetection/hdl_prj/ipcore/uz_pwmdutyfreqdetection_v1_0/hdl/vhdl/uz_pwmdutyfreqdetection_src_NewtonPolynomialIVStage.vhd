-- -------------------------------------------------------------
-- 
-- File Name: hdl_prj\hdlsrc\uz_pwmdutyfreqdetection\uz_pwmdutyfreqdetection_src_NewtonPolynomialIVStage.vhd
-- Created: 2022-05-25 10:12:21
-- 
-- Generated by MATLAB 9.10 and HDL Coder 3.18
-- 
-- -------------------------------------------------------------


-- -------------------------------------------------------------
-- 
-- Module: uz_pwmdutyfreqdetection_src_NewtonPolynomialIVStage
-- Source Path: uz_pwmdutyfreqdetection/uz_pwmdutyfreqdetection/Reciprocal/Reciprocal_iv/NewtonPolynomialIVStage
-- Hierarchy Level: 3
-- 
-- -------------------------------------------------------------
LIBRARY IEEE;
USE IEEE.std_logic_1164.ALL;
USE IEEE.numeric_std.ALL;

ENTITY uz_pwmdutyfreqdetection_src_NewtonPolynomialIVStage IS
  PORT( clk                               :   IN    std_logic;
        reset                             :   IN    std_logic;
        enb_1_23_0                        :   IN    std_logic;
        ain                               :   IN    std_logic_vector(31 DOWNTO 0);  -- ufix32_En32
        mulin                             :   IN    std_logic_vector(33 DOWNTO 0);  -- sfix34_En30
        adderin                           :   IN    std_logic_vector(31 DOWNTO 0);  -- sfix32_En28
        xinitinterm                       :   OUT   std_logic_vector(31 DOWNTO 0)  -- sfix32_En28
        );
END uz_pwmdutyfreqdetection_src_NewtonPolynomialIVStage;


ARCHITECTURE rtl OF uz_pwmdutyfreqdetection_src_NewtonPolynomialIVStage IS

  -- Signals
  SIGNAL mulin_signed                     : signed(33 DOWNTO 0);  -- sfix34_En30
  SIGNAL ain_unsigned                     : unsigned(31 DOWNTO 0);  -- ufix32_En32
  SIGNAL mul_cast                         : signed(32 DOWNTO 0);  -- sfix33_En32
  SIGNAL mul_mul_temp                     : signed(66 DOWNTO 0);  -- sfix67_En62
  SIGNAL mul_cast_1                       : signed(65 DOWNTO 0);  -- sfix66_En62
  SIGNAL mulout                           : signed(31 DOWNTO 0);  -- sfix32_En28
  SIGNAL muloutreg                        : signed(31 DOWNTO 0);  -- sfix32_En28
  SIGNAL adderin_signed                   : signed(31 DOWNTO 0);  -- sfix32_En28
  SIGNAL sumout                           : signed(31 DOWNTO 0);  -- sfix32_En28
  SIGNAL xinitinterm_tmp                  : signed(31 DOWNTO 0);  -- sfix32_En28

BEGIN
  mulin_signed <= signed(mulin);

  ain_unsigned <= unsigned(ain);

  mul_cast <= signed(resize(ain_unsigned, 33));
  mul_mul_temp <= mulin_signed * mul_cast;
  mul_cast_1 <= mul_mul_temp(65 DOWNTO 0);
  mulout <= mul_cast_1(65 DOWNTO 34) + ('0' & mul_cast_1(33));

  mul_reg_process : PROCESS (clk)
  BEGIN
    IF clk'EVENT AND clk = '1' THEN
      IF reset = '1' THEN
        muloutreg <= to_signed(0, 32);
      ELSIF enb_1_23_0 = '1' THEN
        muloutreg <= mulout;
      END IF;
    END IF;
  END PROCESS mul_reg_process;


  adderin_signed <= signed(adderin);

  sumout <= muloutreg + adderin_signed;

  xinitinterm_reg_process : PROCESS (clk)
  BEGIN
    IF clk'EVENT AND clk = '1' THEN
      IF reset = '1' THEN
        xinitinterm_tmp <= to_signed(0, 32);
      ELSIF enb_1_23_0 = '1' THEN
        xinitinterm_tmp <= sumout;
      END IF;
    END IF;
  END PROCESS xinitinterm_reg_process;


  xinitinterm <= std_logic_vector(xinitinterm_tmp);

END rtl;

